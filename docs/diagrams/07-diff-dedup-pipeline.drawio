<mxfile host="app.diagrams.net" agent="Claude" version="24.0.0" type="device">
  <diagram id="diff" name="Built-in Diff (inside remember)">
    <mxGraphModel dx="1422" dy="1200" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1000" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="d_title" value="&lt;b&gt;Built-in Diff (inside remember)&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;Auto dedup &amp; conflict resolution&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;fontSize=16;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="200" y="10" width="500" height="40" as="geometry" />
        </mxCell>
        <mxCell id="d_input" value="&lt;b&gt;mnemon remember&lt;/b&gt; &amp;lt;content&amp;gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=12;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="230" y="60" width="440" height="40" as="geometry" />
        </mxCell>
        <mxCell id="d_kw" value="&lt;b&gt;Step 1: KeywordSearch&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot;&gt;Tokenize new content&lt;br&gt;Score all active insights by token overlap&lt;br&gt;Return top-5 matches&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="290" y="130" width="320" height="65" as="geometry" />
        </mxCell>
        <mxCell id="d_e1" style="edgeStyle=orthogonalEdgeStyle;rounded=1;" edge="1" parent="1" source="d_input" target="d_kw">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="d_sim" value="&lt;b&gt;Step 2: ContentSimilarity&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot;&gt;For each top-5 match:&lt;br&gt;similarity = |tokens_new ∩ tokens_old| / |tokens_new ∪ tokens_old|&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="275" y="225" width="350" height="60" as="geometry" />
        </mxCell>
        <mxCell id="d_e2" style="edgeStyle=orthogonalEdgeStyle;rounded=1;" edge="1" parent="1" source="d_kw" target="d_sim">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="d_neg" value="&lt;b&gt;Step 3: Negation Pattern Detection&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot;&gt;Scan for: not, no longer, don't, never,&lt;br&gt;switched from, replaced, abandoned, changed to&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="275" y="315" width="350" height="55" as="geometry" />
        </mxCell>
        <mxCell id="d_e3" style="edgeStyle=orthogonalEdgeStyle;rounded=1;" edge="1" parent="1" source="d_sim" target="d_neg">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="d_q1" value="similarity &lt; 0.65?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="375" y="405" width="150" height="70" as="geometry" />
        </mxCell>
        <mxCell id="d_e4" style="edgeStyle=orthogonalEdgeStyle;rounded=1;" edge="1" parent="1" source="d_neg" target="d_q1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="d_add" value="&lt;b&gt;ADD&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot;&gt;New content, safe to remember&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="100" y="415" width="200" height="50" as="geometry" />
        </mxCell>
        <mxCell id="d_e5" value="Yes" style="edgeStyle=orthogonalEdgeStyle;rounded=1;fontSize=9;" edge="1" parent="1" source="d_q1" target="d_add">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="d_q2" value="negation&#10;detected?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="375" y="510" width="150" height="70" as="geometry" />
        </mxCell>
        <mxCell id="d_e6" value="No" style="edgeStyle=orthogonalEdgeStyle;rounded=1;fontSize=9;" edge="1" parent="1" source="d_q1" target="d_q2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="d_conflict" value="&lt;b&gt;CONFLICT&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot;&gt;Contradicts existing insight&lt;br&gt;LLM decides: keep old or replace&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=11;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="600" y="515" width="240" height="55" as="geometry" />
        </mxCell>
        <mxCell id="d_e7" value="Yes" style="edgeStyle=orthogonalEdgeStyle;rounded=1;fontSize=9;" edge="1" parent="1" source="d_q2" target="d_conflict">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="d_q3" value="similarity&#10;&gt; 0.90?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="375" y="615" width="150" height="70" as="geometry" />
        </mxCell>
        <mxCell id="d_e8" value="No" style="edgeStyle=orthogonalEdgeStyle;rounded=1;fontSize=9;" edge="1" parent="1" source="d_q2" target="d_q3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="d_dup" value="&lt;b&gt;DUPLICATE&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot;&gt;Already exists, skip remember&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#999999;fontSize=11;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="600" y="625" width="220" height="50" as="geometry" />
        </mxCell>
        <mxCell id="d_e9" value="Yes" style="edgeStyle=orthogonalEdgeStyle;rounded=1;fontSize=9;" edge="1" parent="1" source="d_q3" target="d_dup">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="d_update" value="&lt;b&gt;UPDATE&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot;&gt;Similar but different&lt;br&gt;Consider forget old + remember new&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fce5cd;strokeColor=#d6b656;fontSize=11;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="340" y="720" width="220" height="55" as="geometry" />
        </mxCell>
        <mxCell id="d_e10" value="No (0.65-0.90)" style="edgeStyle=orthogonalEdgeStyle;rounded=1;fontSize=9;" edge="1" parent="1" source="d_q3" target="d_update">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="d_summary_box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#999999;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="80" y="820" width="740" height="100" as="geometry" />
        </mxCell>
        <mxCell id="d_summary_title" value="&lt;b&gt;Decision Matrix&lt;/b&gt;" style="text;html=1;align=left;fontSize=11;fillColor=none;strokeColor=none;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="100" y="828" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="d_summary" value="&lt;table style=&quot;font-size:10px; border-collapse:collapse;&quot;&gt;&lt;tr style=&quot;font-weight:bold; background:#eee;&quot;&gt;&lt;th style=&quot;padding:4px 12px; border:1px solid #ccc;&quot;&gt;Similarity&lt;/th&gt;&lt;th style=&quot;padding:4px 12px; border:1px solid #ccc;&quot;&gt;Negation&lt;/th&gt;&lt;th style=&quot;padding:4px 12px; border:1px solid #ccc;&quot;&gt;Action&lt;/th&gt;&lt;th style=&quot;padding:4px 12px; border:1px solid #ccc;&quot;&gt;Meaning&lt;/th&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style=&quot;padding:3px 12px; border:1px solid #ccc;&quot;&gt;&amp;lt; 0.65&lt;/td&gt;&lt;td style=&quot;padding:3px 12px; border:1px solid #ccc;&quot;&gt;-&lt;/td&gt;&lt;td style=&quot;padding:3px 12px; border:1px solid #ccc; color:#82b366; font-weight:bold;&quot;&gt;ADD&lt;/td&gt;&lt;td style=&quot;padding:3px 12px; border:1px solid #ccc;&quot;&gt;New information&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style=&quot;padding:3px 12px; border:1px solid #ccc;&quot;&gt;0.65 - 0.90&lt;/td&gt;&lt;td style=&quot;padding:3px 12px; border:1px solid #ccc;&quot;&gt;Yes&lt;/td&gt;&lt;td style=&quot;padding:3px 12px; border:1px solid #ccc; color:#b85450; font-weight:bold;&quot;&gt;CONFLICT&lt;/td&gt;&lt;td style=&quot;padding:3px 12px; border:1px solid #ccc;&quot;&gt;Contradicts existing&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style=&quot;padding:3px 12px; border:1px solid #ccc;&quot;&gt;&amp;gt; 0.90&lt;/td&gt;&lt;td style=&quot;padding:3px 12px; border:1px solid #ccc;&quot;&gt;No&lt;/td&gt;&lt;td style=&quot;padding:3px 12px; border:1px solid #ccc; color:#999; font-weight:bold;&quot;&gt;DUPLICATE&lt;/td&gt;&lt;td style=&quot;padding:3px 12px; border:1px solid #ccc;&quot;&gt;Already stored&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style=&quot;padding:3px 12px; border:1px solid #ccc;&quot;&gt;0.65 - 0.90&lt;/td&gt;&lt;td style=&quot;padding:3px 12px; border:1px solid #ccc;&quot;&gt;No&lt;/td&gt;&lt;td style=&quot;padding:3px 12px; border:1px solid #ccc; color:#d6b656; font-weight:bold;&quot;&gt;UPDATE&lt;/td&gt;&lt;td style=&quot;padding:3px 12px; border:1px solid #ccc;&quot;&gt;Evolved version&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;" style="rounded=0;whiteSpace=wrap;html=1;overflow=fill;fillColor=none;strokeColor=none;" vertex="1" parent="1">
          <mxGeometry x="100" y="850" width="700" height="60" as="geometry" />
        </mxCell>
        <mxCell id="d_wf_title" value="&lt;b&gt;New Workflow (single command)&lt;/b&gt;" style="text;html=1;align=left;fontSize=11;fillColor=none;strokeColor=none;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="80" y="940" width="300" height="20" as="geometry" />
        </mxCell>
        <mxCell id="d_wf1" value="&lt;font style=&quot;font-size:10px; font-family:monospace;&quot;&gt;mnemon remember &quot;new fact&quot;&lt;br&gt;--cat decision --imp 5&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="80" y="965" width="220" height="40" as="geometry" />
        </mxCell>
        <mxCell id="d_wf2" value="&lt;font style=&quot;font-size:10px&quot;&gt;Built-in diff auto-runs&lt;br&gt;&lt;/font&gt;&lt;font style=&quot;font-size:9px&quot;&gt;DUPLICATE→skip | CONFLICT→replace | ADD→insert&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="340" y="962" width="280" height="45" as="geometry" />
        </mxCell>
        <mxCell id="d_wf3" value="&lt;font style=&quot;font-size:10px&quot;&gt;JSON output with&lt;br&gt;action + replaced_id&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="660" y="965" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="d_wfe1" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#999;" edge="1" parent="1" source="d_wf1" target="d_wf2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="d_wfe2" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#999;" edge="1" parent="1" source="d_wf2" target="d_wf3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
